!function(){var a={findIndex:function(a,b){for(var c in a)if(b(a[c]))return c<<0;return-1},find:function(a,b){for(var c in a){var d=a[c];if(b(d))return d}return null}},b={PAGES:[{page:"xebia",title:"Xebia",url:"index.html",mainUrl:"http://www.xebia.fr",urlDetail:"xebia-detail.html"},{page:"ux",title:"UX Republic",url:"ux.html",mainUrl:"http://ux-republic.com",urlDetail:"ux-detail.html"},{page:"labs",title:"Xebia Labs",url:"labs.html",mainUrl:"http://www.xebialabs.com",urlDetail:"labs-detail.html"},{page:"thiga",title:"THIGA",url:"thiga.html",mainUrl:"http://www.thiga.fr",urlDetail:"thiga-detail.html"}],currentPage:null,isCurrentDetail:null,findIndex:function(b){return a.findIndex(this.PAGES,function(a){return b.page==a.page})},findByName:function(b){return a.find(this.PAGES,function(a){return a.page==b})},findNext:function(){var a=this.findIndex(this.currentPage),b=a>=this.totalPages()-1?0:a+1;return this.findByIndex(b)},findPrev:function(){var a=this.findIndex(this.currentPage),b=1>a?this.totalPages()-1:a-1;return this.findByIndex(b)},findByIndex:function(a){return this.PAGES[a]},totalPages:function(){return this.PAGES.length},isCurrentPage:function(a){return this.currentPage.page==a.page}},c=function(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDay();return""+b+"-"+c+"-"+d},d={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},e=function(a){var b=a.getFullYear(),c=a.getMonth()+1,e=d[""+c],f=a.getDate();return""+f+" "+e+" "+b},f=function(a){var b=parseInt(a.substr(0,4),10),c=parseInt(a.substr(5,2),10)-1,d=parseInt(a.substr(8,2),10),e=parseInt(a.substr(11,2),10),f=parseInt(a.substr(14,2),10),g=parseInt(a.substr(17,2),10);return new Date(b,c,d,e,f,g)},g={TEMPLATE_BLOCK:'<section class="block standard-block"><div class="title-block"><time></time></div><div class="content-block"><h1></h1></div></section>',initXebiaTemplateBlock:function(a,b,d,f){var g=$(this.TEMPLATE_BLOCK);g.addClass(a).addClass("xebia");var h=g.find(".title-block");return h.addClass("xebia-title").prepend("Xebia"),h.find("time").attr("datetime",c(b)).text(e(b)),g.find("h1").html('<a href="'+f+'">'+d+"</a>"),g}},h=function(a){this.currentFilter="block",this.$blockContent=$("#blockContent"),this.$blockContent.mixitup({targetSelector:".block",showOnLoad:a?"none":"all"}),this.$blockContent.sortable()};h.prototype.sort=function(a){this.$blockContent.mixitup("sort",a)},h.prototype.filter=function(a){a||(a="block"),this.currentFilter=a,this.$blockContent.mixitup("filter",a)},h.prototype.remix=function(){this.$blockContent.mixitup("remix",this.currentFilter)},h.prototype.randomize=function(){this.sort("random")},window.APPLICATION={navigationIntervalIndex:null,mixitup:null,init:function(a){var c=a.replace(" detail","");b.currentPage=b.findByName(c),b.isCurrentDetail=a.indexOf("detail")>=0,this.initRouting(),this.initNavigation(),this.initBlocks(),this.initStickyHeader(),this.initMenuMobile(),this.initSubLevel(),this.loadSubpage(),this.initClickAllianceLogo()},loadSubpage:function(){b.isCurrentDetail&&this.goToSubPage(b.currentPage)},initMenuMobile:function(){$(".stripes").click(function(){$(this).toggleClass("on"),$(".frise").toggleClass("open")})},initSubLevel:function(){var a=this;$(".frise a").removeAttr("href").click(function(){var c=$(this).attr("class"),d=b.findByName(c);b.isCurrentPage(d)&&b.isCurrentDetail?a.mixitup.randomize():a.subNavigate(d)})},initStickyHeader:function(){var a=$(window),b=$("header"),c=b.position().top+b.height(),d=$(".frise"),e=c-d.height();a.scroll(function(){a.scrollTop()>e?d.css({position:"fixed",top:0,bottom:"inherit"}):d.attr("style","")})},initRouting:function(){var a=this;window.onpopstate=function(b){var c=b.state;if(c){var d=c.page;"detail"==c.mode?a.goToSubPage(d):a.goToPage(d)}}},initBlocks:function(){this.initEventbriteBlock(),this.initBlogBlock(),this.mixitup=new h(b.isCurrentDetail)},displayBlogPost:function(a){var b=f(a.date),c=a.title,d=a.content,e=a.url,h=g.initXebiaTemplateBlock("blog-block",b,c,e),i=h.find(".content-block"),j=$('<div class="excerpt"><div class="excerpt-content">'+d+"</div></div>");j.find(".more-link").remove(),j.find("img").css("width","inherit").css("height","inherit"),i.append(j),this.addAndDisplayXebiaBlock(h)},initBlogBlock:function(){var a=this,b="http://blog.xebia.fr/wp-json-api/get_recent_posts/?count=1",c=$.ajax(b,{dataType:"jsonp"});c.done(function(b){var c=b.posts;c.length<1||c.forEach(function(b){a.displayBlogPost(b)})})},initEventbriteBlock:function(){var b=this;Eventbrite({app_key:"UW2IBMBZKW4U6EPHQK"},function(c){c.organizer_list_events({id:1627902102,only_display:"url, status, start_date, title, logo"},function(c){if(c.events&&c.events.length>0){var d=(new Date).getTime(),e=a.find(c.events,function(a){var b=a.event,c=f(b.start_date);return c.getTime()>d&&"Live"==b.status});if(e){var g=e.event;g.title&&b.updateEventbriteBlock("Xebia",f(g.start_date),g.title,g.url,g.logo,"logo "+g.title)}}})})},initClickAllianceLogo:function(){var a=this;$(".alliance-logo").click(function(){b.isCurrentDetail?(a.navigate(b.currentPage),a.mixitup.filter()):a.mixitup.randomize()})},initNavigation:function(){var a=this,c=$(".headers"),d=100*(c.css("left").replace("px","")<<0)/c.width();c.css("left",d+"%"),c.find("> div").css("display","block"),$(".next-page").click(function(){a.goToNextPage()}),$(".prev-page").click(function(){a.goToPrevPage()}),$(".page-indicators > span").click(function(){var c=$(".page-indicators > span").index(this),d=b.findByIndex(c);a.navigate(d)}),this.initNavigationInterval()},goToNextPage:function(){var a=b.findNext();this.navigate(a)},goToPrevPage:function(){var a=b.findPrev();this.navigate(a)},initNavigationInterval:function(){clearInterval(this.navigationIntervalIndex);var a=this;this.navigationIntervalIndex=setInterval(function(){a.goToNextPage()},1e4)},instrumentKnowingMore:function(a){$(".knowing-more a").attr("href",a.mainUrl).attr("title",a.title)},goToPage:function(a){var c=b.findIndex(a);$(".wrapper").attr("class","wrapper "+a.page),b.isCurrentDetail=!1,this.mixitup.filter(),this.instrumentKnowingMore(a),$(".headers").animate({left:100*-c+"%"},500,function(){b.currentPage=a}),this.initNavigationInterval()},goToSubPage:function(a){this.instrumentKnowingMore(a),clearInterval(this.navigationIntervalIndex),$(".wrapper").attr("class","wrapper "+a.page+" detail"),b.currentPage=a,b.isCurrentDetail=!0,this.mixitup.filter(a.page)},navigate:function(a){this.goToPage(a),history.pushState({page:a,mode:"normal"},a.title,a.url)},subNavigate:function(a){this.goToSubPage(a),history.pushState({page:a,mode:"detail"},a.title,a.urlDetail)},addAndDisplayXebiaBlock:function(a){var b=$("#blockContent");b.append(a),a.css("display","inline-block"),a.animate({opacity:1}),this.mixitup.remix()},updateEventbriteBlock:function(a,b,c,d,e,f){var h=g.initXebiaTemplateBlock("eventbrite-block",b,c,d),i=h.find(".content-block");i.append('<div class="bottom-arrow"></div>'),i.append('<img src="'+e+'" alt="'+f+'" class="illustration big-illustration"/>'),this.addAndDisplayXebiaBlock(h)}}}();